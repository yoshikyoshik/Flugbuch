<!DOCTYPE html>
<html lang="de">
  <head>
    <meta charset="UTF-8" />
    <script>
      // Initiales Laden des Themes, um Flackern zu verhindern
      //
      if (
        localStorage.theme === "dark" ||
        (!("theme" in localStorage) &&
          window.matchMedia("(prefers-color-scheme: dark)").matches)
      ) {
        document.documentElement.classList.add("dark");
      } else {
        document.documentElement.classList.remove("dark");
      }
    </script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AvioSphere - Flight Log & 3D Tracker</title>
	
	<link rel="icon" href="pictures/logo.png?v=2" type="image/png">

    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    />
	<link
      rel="stylesheet"
      href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.css"
    />
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.Default.css"
    />
	
	<link rel="stylesheet" href="style.css" />
	
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
	<script src="https://unpkg.com/leaflet.markercluster@1.5.3/dist/leaflet.markercluster.js"></script>
    <script src="https://unpkg.com/leaflet-polylinedecorator@1.6.0/dist/leaflet.polylineDecorator.js"></script>
    <script src="//unpkg.com/globe.gl@latest"></script>
    <script src="https://cdn.tailwindcss.com"></script>
	<script>
	  tailwind.config = {
		darkMode: 'class', // Zwingt Tailwind, auf class="dark" zu achten
	  }
	</script>
	
	<script src="js/config.js"></script>
	<script src="js/helpers.js"></script>    
    <script src="js/supabase.js"></script>   
    <script src="js/map.js"></script>        
    <script src="js/ui.js"></script>         
    <script src="js/tutorial.js"></script>
	<script src="js/app.js"></script>
	
    <style>
	/* --- CSS befindet sich in style.css --- */
	</style>
	
  </head>

  <body class="bg-gray-100 dark:bg-gray-900">
    <div
      id="auth-container"
      class="min-h-screen flex items-center justify-center p-4 bg-gray-100 dark:bg-gray-900"
    >
      <div
        class="w-full max-w-5xl bg-white dark:bg-gray-800 shadow-2xl rounded-2xl overflow-hidden flex flex-col md:flex-row"
      >
        <div class="md:w-1/2 bg-indigo-600 p-8 text-white flex flex-col justify-between relative overflow-hidden">
          <div class="absolute top-0 right-0 -mr-10 -mt-10 w-40 h-40 bg-white opacity-10 rounded-full blur-3xl"></div>
          
          <div class="relative z-10">
            <div class="flex items-center gap-3 mb-8">
               <img src="pictures/logo.png" alt="AvioSphere Logo" class="w-12 h-12 rounded-xl bg-white p-1 shadow-md">
               <h1 class="text-3xl font-extrabold tracking-tight">AvioSphere</h1>
            </div>
            
            <h2 class="text-2xl font-bold mb-4" data-i18n="landing.headline">Mache deine Reisen unvergesslich.</h2>
            <p class="text-indigo-100 mb-8 text-lg leading-relaxed" data-i18n="landing.subheadline">
              Das ultimative digitale Flugbuch f√ºr Vielflieger und Luftfahrt-Enthusiasten.
            </p>

            <ul class="space-y-5 text-indigo-50 font-medium">
              <li class="flex items-center gap-4">
                <span class="text-2xl bg-indigo-500/30 p-2 rounded-lg">üåç</span>
                <span data-i18n="landing.featureGlobus">Interaktiver 3D-Globus deiner Reisen</span>
              </li>
              <li class="flex items-center gap-4">
                <span class="text-2xl bg-indigo-500/30 p-2 rounded-lg">üìä</span>
                <span data-i18n="landing.featureStats">Detaillierte Statistiken & Charts</span>
              </li>
              <li class="flex items-center gap-4">
                <span class="text-2xl bg-indigo-500/30 p-2 rounded-lg">‚úàÔ∏è</span>
                <span data-i18n="landing.featureAutopilot">Autopilot: Daten per Flugnummer</span>
              </li>
              <li class="flex items-center gap-4">
                <span class="text-2xl bg-indigo-500/30 p-2 rounded-lg">üì∏</span>
                <span data-i18n="landing.featurePhotos">Foto-Upload & PDF-Export</span>
              </li>
            </ul>
          </div>

          <div class="mt-10 text-xs text-indigo-200 relative z-10">
            <p class="mb-2">¬© <span id="current-year"></span> AvioSphere. All rights reserved.</p>
            <div class="flex flex-wrap gap-4">
                <a id="link-privacy" href="privacy.html" target="_blank" class="hover:text-white underline decoration-indigo-400" data-i18n="landing.privacy">Datenschutzerkl√§rung</a>
                <a id="link-terms" href="terms.html" target="_blank" class="hover:text-white underline decoration-indigo-400" data-i18n="landing.terms">AGB & Impressum</a>
            </div>
          </div>
        </div>

        <div class="md:w-1/2 p-8 md:p-12 bg-white dark:bg-gray-800 overflow-y-auto relative">
            
            <div class="absolute top-4 right-4 flex gap-2">
                <button onclick="setLanguage('de')" class="text-sm font-medium text-gray-500 hover:text-indigo-600 dark:text-gray-400 dark:hover:text-white transition">DE</button>
                <span class="text-gray-300">|</span>
                <button onclick="setLanguage('en')" class="text-sm font-medium text-gray-500 hover:text-indigo-600 dark:text-gray-400 dark:hover:text-white transition">EN</button>
            </div>

            <div class="md:hidden flex justify-center mb-6 mt-4">
                <img src="pictures/logo.png" alt="Logo" class="w-16 h-16 rounded-xl shadow-md">
            </div>

            <div class="text-center mb-8 mt-2">
                <h2 class="text-2xl font-bold text-gray-800 dark:text-white" data-i18n="loginWelcome">Willkommen an Bord</h2>
                <p class="text-sm text-gray-500 dark:text-gray-400 mt-2">Melde dich an, um dein Logbuch zu starten.</p>
            </div>

            <div id="auth-tabs" class="flex justify-center border-b border-gray-200 dark:border-gray-700 mb-6">
              <button onclick="switchAuthTab('login')" id="login-tab" data-i18n="login" class="auth-tab active-tab px-6 py-2 font-semibold text-lg transition-colors">Login</button>
              <button onclick="switchAuthTab('register')" id="register-tab" data-i18n="register" class="auth-tab px-6 py-2 font-semibold text-lg transition-colors">Registrieren</button>
            </div>

            <form id="login-form" class="space-y-5">
              <div>
                  <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1" data-i18n="placeholder.email">E-Mail</label>
                  <input type="email" id="login-email" required class="w-full p-3 rounded-lg border border-gray-300 dark:bg-gray-700 dark:border-gray-600 focus:ring-2 focus:ring-indigo-500 outline-none transition" />
              </div>
              <div>
                  <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1" data-i18n="placeholder.password">Passwort</label>
                  <input type="password" id="login-password" required class="w-full p-3 rounded-lg border border-gray-300 dark:bg-gray-700 dark:border-gray-600 focus:ring-2 focus:ring-indigo-500 outline-none transition" />
              </div>
              <div class="text-right">
                <a href="#" onclick="event.preventDefault(); showPasswordResetForm();" data-i18n="forgotPWD" class="text-sm font-medium text-indigo-600 hover:underline dark:text-indigo-400">Passwort vergessen?</a>
              </div>
              <button type="submit" data-i18n="login" class="w-full py-3 bg-indigo-600 text-white font-bold rounded-lg hover:bg-indigo-700 transition shadow-lg hover:shadow-xl transform hover:-translate-y-0.5">
                Einloggen
              </button>
            </form>

            <form id="register-form" class="space-y-5 hidden">
              <div>
                  <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1" data-i18n="placeholder.email">E-Mail</label>
                  <input type="email" id="register-email" required class="w-full p-3 rounded-lg border border-gray-300 dark:bg-gray-700 dark:border-gray-600 focus:ring-2 focus:ring-green-500 outline-none transition" />
              </div>
              <div>
                  <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1" data-i18n="placeholder.password">Passwort</label>
                  <input type="password" id="register-password" required class="w-full p-3 rounded-lg border border-gray-300 dark:bg-gray-700 dark:border-gray-600 focus:ring-2 focus:ring-green-500 outline-none transition" />
              </div>
              <button type="submit" data-i18n="registerFree" class="w-full py-3 bg-green-600 text-white font-bold rounded-lg hover:bg-green-700 transition shadow-lg hover:shadow-xl transform hover:-translate-y-0.5">
                Kostenlos Registrieren
              </button>
              <p class="text-xs text-center text-gray-500 dark:text-gray-400 mt-4">
                  Mit der Registrierung akzeptierst du unsere <a id="link-terms-small" href="terms.html" target="_blank" class="underline hover:text-indigo-600">AGB</a> und <a id="link-privacy-small" href="privacy.html" target="_blank" class="underline hover:text-indigo-600">Datenschutz</a>.
              </p>
            </form>

            <div id="password-reset-container" class="hidden space-y-4">
                <div class="text-center mt-4">
                    <a href="#" onclick="event.preventDefault(); backToLogin();" data-i18n="backToLogin" class="text-sm font-medium text-indigo-600 hover:underline dark:text-indigo-400">Zur√ºck zum Login</a>
                </div>
            </div>
            
            <form id="request-reset-form" class="space-y-4 hidden">
                <p data-i18n="newMail4Link4PWD" class="text-sm text-center text-gray-600 dark:text-gray-400">Gib deine E-Mail-Adresse ein...</p>
                <input type="email" id="reset-email" placeholder="E-Mail" required class="w-full p-3 rounded-lg border border-gray-300 dark:bg-gray-700 dark:border-gray-600" />
                <button type="submit" data-i18n="reset" class="w-full py-3 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition">Reset-Link anfordern</button>
              </form>
              <form id="update-password-form" class="space-y-4 hidden">
                 <input type="password" id="update-password-input" placeholder="Neues Passwort" required class="w-full p-3 rounded-lg border-gray-300 dark:bg-gray-700 dark:border-gray-600" />
                 <button type="submit" data-i18n="saveNewPWD" class="w-full py-3 bg-green-500 text-white rounded-lg hover:bg-green-600 transition">Neues Passwort speichern</button>
              </form>

            <p id="auth-error" class="text-red-500 text-sm mt-6 text-center font-medium"></p>
        </div>
      </div>
    </div>

    <div
      id="app-container"
      class="hidden min-h-screen p-4 md:p-8 flex items-center justify-center"
    >
      <div
        class="w-full max-w-4xl bg-white dark:bg-gray-800 shadow-2xl rounded-xl p-6 md:p-10 border border-gray-100 dark:border-gray-700"
      >
        <div class="flex justify-between items-center mb-2">
          <div id="app-header-logo" class="flex items-center gap-3 cursor-pointer select-none">
            <img
              src="pictures/logo.png"
              alt="Logo"
              class="w-10 h-10 rounded-lg shadow-md"
            />
            <h1
              class="text-2xl md:text-3xl font-extrabold text-gray-800 dark:text-white tracking-tight"
            >
              AvioSphere
            </h1>
          </div>
          <div class="relative">
            <button
              id="burger-menu-btn"
              class="p-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700"
            >
              <svg
                class="w-6 h-6"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M4 6h16M4 12h16m-7 6h7"
                ></path>
              </svg>
            </button>
            <div
              id="burger-menu"
              class="hidden absolute right-0 mt-2 w-56 bg-white dark:bg-gray-800 rounded-md shadow-lg z-50 border dark:border-gray-700"
            >
              <div class="md:hidden border-b dark:border-gray-700">
                <a
                  href="#"
                  onclick="event.preventDefault(); showTab('neue-fluege'); toggleBurgerMenu();"
                  data-i18n="burgerMenu.newFlight"
                  class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"
                  >Neuer Flug</a
                >
                <a
                  href="#"
                  onclick="event.preventDefault(); showTab('fluege'); toggleBurgerMenu();"
                  data-i18n="burgerMenu.flights"
                  class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"
                  >Fl√ºge</a
                >
                <a
                  href="#"
                  onclick="event.preventDefault(); showTab('stats'); toggleBurgerMenu();"
                  data-i18n="burgerMenu.stats"
                  class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"
                  >Statistiken</a
                >
                <a
                  href="#"
                  onclick="event.preventDefault(); showTab('charts'); toggleBurgerMenu();"
                  data-i18n="burgerMenu.charts"
                  class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"
                  >Charts</a
                >
                <a
                  href="#"
                  onclick="event.preventDefault(); showTab('logbook'); toggleBurgerMenu();"
                  data-i18n="burgerMenu.logbook"
                  class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"
                  >Logbuch</a
                >
                <a
                  href="#"
                  onclick="event.preventDefault(); showTab('achievements'); toggleBurgerMenu();"
                  data-i18n="burgerMenu.achievements"
                  class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"
                  >Errungenschaften</a
                >
                <a
                  href="#"
                  onclick="event.preventDefault(); showTab('hilfe'); toggleBurgerMenu();"
                  data-i18n="burgerMenu.help"
                  class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"
                  >Hilfe</a
                >
              </div>

              <div
                class="border-b dark:border-gray-700 py-1 flex justify-around"
              >
                <button
                  onclick="setLanguage('de'); toggleBurgerMenu();"
                  class="p-2 text-sm font-medium rounded-md hover:bg-gray-100 dark:hover:bg-gray-700"
                >
                  üá©üá™ DE
                </button>

                <button
                  onclick="setLanguage('en'); toggleBurgerMenu();"
                  class="p-2 text-sm font-medium rounded-md hover:bg-gray-100 dark:hover:bg-gray-700"
                >
                  üá¨üáß EN
                </button>

                <button
                  onclick="setLanguage('es'); toggleBurgerMenu();"
                  class="p-2 text-sm font-medium rounded-md hover:bg-gray-100 dark:hover:bg-gray-700"
                >
                  üá™üá∏ ES
                </button>

                <button
                  onclick="setLanguage('ru'); toggleBurgerMenu();"
                  class="p-2 text-sm font-medium rounded-md hover:bg-gray-100 dark:hover:bg-gray-700"
                >
                  üá∑üá∫ RU
                </button>

                <button
                  onclick="setLanguage('zh'); toggleBurgerMenu();"
                  class="p-2 text-sm font-medium rounded-md hover:bg-gray-100 dark:hover:bg-gray-700"
                >
                  üá®üá≥ ZH
                </button>
              </div>

              <div class="border-b dark:border-gray-700 py-1">
                <a
                  href="#"
                  onclick="event.preventDefault(); exportData('json'); toggleBurgerMenu();"
                  data-i18n="burgerMenu.exportJSON"
                  class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"
                >
                  Daten Exportieren (JSON)
                </a>
                <a
                  href="#"
                  onclick="event.preventDefault(); exportData('csv'); toggleBurgerMenu();"
                  data-i18n="burgerMenu.exportCSV"
                  class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"
                >
                  Daten Exportieren (CSV)
                </a>
                <label
                  for="import-file-input"
                  data-i18n="burgerMenu.importJSON"
                  class="block px-4 py-2 text-sm text-red-500 dark:text-red-400 hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer"
                >
                  Daten Importieren (JSON)...
                </label>
              </div>

              <div class="py-1">
                <a
                  href="#"
                  onclick="event.preventDefault(); showPasswordChangeModal()"
                  data-i18n="burgerMenu.changePassword"
                  class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"
                  >Passwort √§ndern</a
                >
                <a
                  href="#"
                  id="menu-theme-toggle"
                  data-i18n="burgerMenu.toggleMode"
                  class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"
                  >Modus wechseln</a
                >
                <a
                  href="#"
                  id="menu-logout-btn"
                  data-i18n="burgerMenu.logout"
                  class="block px-4 py-2 text-sm text-red-600 dark:text-red-400 hover:bg-gray-100 dark:hover:bg-gray-700"
                  >Logout</a
                >
              </div>
              <div class="border-t dark:border-gray-700 px-4 py-2">
                <span
                  id="user-display"
                  class="block text-xs text-gray-500"
                ></span>
                <span
                  id="app-version"
                  class="block text-xs text-gray-400"
                ></span>
                <span
                  id="subscription-status-badge"
                  class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium mt-1 bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300"
                >
                  Lade Status...
                </span>
                <button
                  id="menu-upgrade-btn"
                  onclick="openPremiumModal()"
                  class="hidden mt-3 w-full text-center text-xs font-semibold text-white bg-gradient-to-r from-indigo-500 to-purple-600 hover:from-indigo-600 hover:to-purple-700 py-2 rounded shadow transition-all"
                  data-i18n="premium.menuBtn"
                >
                  üöÄ Upgrade auf Pro
                </button>
                <button
                  id="menu-manage-sub-btn"
                  onclick="manageSubscription()"
                  class="hidden mt-3 w-full text-center text-xs font-medium text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 py-2 rounded border border-gray-200 dark:border-gray-600 transition-all"
                  data-i18n="burgerMenu.manageSubscription"
                >
                  ‚öôÔ∏è Abo verwalten
                </button>
              </div>
            </div>
          </div>
        </div>

        <details class="mb-6 group" open>
          <summary
            class="list-none cursor-pointer border-b pb-2 border-gray-200 dark:border-gray-700"
          >
            <h2
              data-i18n="lastFlightMap"
              class="text-xl md:text-2xl font-bold text-gray-800 dark:text-white inline-block"
            >
              Zuletzt geloggter/bearbeiteter Flug
            </h2>

            <div class="float-right flex items-center pt-2">
              <span
                data-i18n="help.expand"
                class="text-xs text-gray-500 dark:text-gray-400 mr-1 group-open:hidden"
              >
                Ausklappen
              </span>

              <span
                data-i18n="help.collapse"
                class="text-xs text-gray-500 dark:text-gray-400 mr-1 hidden group-open:inline"
              >
                Einklappen
              </span>

              <span
                class="text-red-500 dark:text-red-400 group-open:rotate-90 transition-transform duration-200"
                >‚ñ∂</span
              >
            </div>
          </summary>

          <div class="mt-4">
            <p
              id="map-info"
              data-i18n="mapVisualization"
              class="text-center text-sm text-gray-700 dark:text-gray-300 mb-2 italic"
            >
              Flugroute wird visualisiert.
            </p>
            <div
              id="return-flight-container"
              class="text-center -mt-1 mb-3 hidden"
            >
              <button
                id="return-flight-btn"
                onclick=""
                data-i18n="flights.logReturnFlight"
                class="py-1 px-3 text-xs bg-indigo-600 text-white rounded-full hover:bg-indigo-700 transition-colors shadow-md"
              >
                ‚úàÔ∏è R√ºckflug loggen
              </button>
            </div>
            <div
              id="flight-map-container"
              class="h-[300px] rounded-lg shadow-lg z-0"
            ></div>
          </div>
        </details>
        <div>
          <div class="border-b border-gray-200 dark:border-gray-700">
            <nav class="hidden md:flex -mb-px space-x-6" aria-label="Tabs">
              <button
                onclick="showTab('neue-fluege')"
                id="tab-btn-neue-fluege"
                data-i18n="tabs.newFlight"
                class="tab-btn whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm border-indigo-500 text-indigo-600"
              >
                Neuer Flug
              </button>
              <button
                onclick="showTab('fluege')"
                id="tab-btn-fluege"
                data-i18n="tabs.flights"
                class="tab-btn whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm border-indigo-500 text-indigo-600"
              >
                Fl√ºge
              </button>
              <button
                onclick="showTab('stats')"
                id="tab-btn-stats"
                data-i18n="tabs.stats"
                class="tab-btn whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"
              >
                Statistiken
              </button>
              <button
                onclick="showTab('charts')"
                id="tab-btn-charts"
                data-i18n="tabs.charts"
                class="tab-btn whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"
              >
                Charts
              </button>
              <button
                onclick="showTab('logbook')"
                id="tab-btn-logbook"
                data-i18n="tabs.logbook"
                class="tab-btn whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"
              >
                Logbuch
              </button>
              <button
                onclick="showTab('achievements')"
                id="tab-btn-achievements"
                data-i18n="tabs.achievements"
                class="tab-btn whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"
              >
                Errungenschaften
              </button>
              <button
                onclick="showTab('hilfe')"
                id="tab-btn-hilfe"
                data-i18n="tabs.help"
                class="tab-btn whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"
              >
                Hilfe
              </button>
            </nav>
          </div>
          <div class="py-6">
            <div id="tab-content-neue-fluege">
              <p
                data-i18n="tagline"
                class="text-gray-500 dark:text-gray-400 mb-8"
              >
                W√§hlen Sie einen Flughafen aus der Liste oder geben Sie einen
                Code/Namen manuell ein.
              </p>

              <details
                class="bg-gray-50 dark:bg-gray-700 p-5 rounded-lg mb-6 shadow-inner border dark:border-gray-600 group"
                open
              >
                <summary class="list-none cursor-pointer">
                  <span
                    class="float-right text-indigo-400 group-open:rotate-90 transition-transform duration-200 pt-1"
                  >
                    >
                  </span>

                  <h3
                    class="text-lg font-semibold text-indigo-600 dark:text-indigo-400 flex items-center gap-2"
                  >
                    <span data-i18n="autoPilot"
                      >Autopilot: Flugdaten per Flugnummer laden</span
                    >
                  </h3>
                </summary>

                <div class="grid grid-cols-1 sm:grid-cols-3 gap-4 items-end">
                  <div>
                    <label
                      for="auto-flight-number"
                      data-i18n="autoFlightNumber"
                      class="block text-sm font-medium text-gray-700 dark:text-gray-300"
                      >Flugnummer</label
                    >
                    <input
                      type="text"
                      id="auto-flight-number"
                      placeholder="z.B. LH202"
                      data-i18n="placeholder.egFlightNumber"
                      class="mt-1 block w-full rounded-lg border-gray-300 shadow-sm p-3"
                    />
                  </div>
                  <div>
                    <label
                      for="auto-flight-date"
                      data-i18n="autoFlightDate"
                      class="block text-sm font-medium text-gray-700 dark:text-gray-300"
                      >Flugdatum</label
                    >
                    <input
                      type="date"
                      id="auto-flight-date"
                      class="mt-1 block w-full rounded-lg border-gray-300 shadow-sm p-3"
                    />
                  </div>
                  <button
                    id="autofill-btn"
                    data-i18n="autofillBtn"
                    class="w-full py-3 px-4 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition"
                  >
                    Daten abrufen
                  </button>
                </div>
              </details>

              <details
                class="bg-indigo-50 dark:bg-gray-900 p-5 rounded-lg mb-6 shadow-inner group"
                open
              >
                <summary class="list-none cursor-pointer">
                  <h2
                    data-i18n="logNewFlight"
                    class="text-xl font-semibold text-indigo-600 dark:text-indigo-400 inline-block"
                  >
                    Neuen Flug loggen
                  </h2>
                  <span
                    class="float-right text-indigo-400 group-open:rotate-90 transition-transform duration-200 pt-1"
                  >
                    >
                  </span>
                </summary>

                <div
                  class="mt-4 pt-4 border-t border-indigo-200 dark:border-gray-700 
                            grid grid-cols-1 lg:grid-cols-6 gap-x-6 gap-y-4"
                >
                  <div class="autocomplete-container lg:col-span-3">
                    <label
                      for="departure"
                      data-i18n="departureNewFlight"
                      class="block text-sm font-medium text-gray-700 dark:text-gray-300"
                      >Abflugort (IATA/Name)</label
                    >
                    <input
                      type="text"
                      id="departure"
                      placeholder="z.B. FRA"
                      data-i18n="placeholder.egDeparture"
                      class="mt-1 block w-full rounded-lg border-gray-300 shadow-sm p-3 focus:ring-indigo-500 focus:border-indigo-500 transition duration-150"
                    />
                    <div
                      id="departure-list"
                      class="autocomplete-list hidden rounded-lg"
                    ></div>
                  </div>
                  <div class="autocomplete-container lg:col-span-3">
                    <label
                      for="arrival"
                      data-i18n="arrivalNewFlight"
                      class="block text-sm font-medium text-gray-700 dark:text-gray-300"
                      >Zielort (IATA/Name)</label
                    >
                    <input
                      type="text"
                      id="arrival"
                      placeholder="z.B. JFK"
                      data-i18n="placeholder.egArrival"
                      class="mt-1 block w-full rounded-lg border-gray-300 shadow-sm p-3 focus:ring-indigo-500 focus:border-indigo-500 transition duration-150"
                    />
                    <div
                      id="arrival-list"
                      class="autocomplete-list hidden rounded-lg"
                    ></div>
                  </div>

                  <div class="lg:col-span-3">
                    <label
                      for="flightDate"
                      data-i18n="flightDateNewFlight"
                      class="block text-sm font-medium text-gray-700 dark:text-gray-300"
                      >Flugdatum (Optional)</label
                    ><input
                      type="date"
                      id="flightDate"
                      class="mt-1 block w-full rounded-lg border-gray-300 shadow-sm p-3"
                    />
                  </div>
                  <div class="lg:col-span-3">
                    <label
                      for="flightClass"
                      data-i18n="flightClassNewFlight"
                      class="block text-sm font-medium text-gray-700 dark:text-gray-300"
                      >Klasse/Zweck (Optional)</label
                    ><select
                      id="flightClass"
                      class="mt-1 block w-full rounded-lg border-gray-300 shadow-sm p-3 bg-white"
                    >
                      <option value="Economy" data-i18n="flightClassEconomy">
                        Economy
                      </option>
                      <option value="Business" data-i18n="flightClassBusiness">
                        Business
                      </option>
                      <option value="First" data-i18n="flightClassFirst">
                        First
                      </option>
                      <option value="Privat" data-i18n="flightClassPrivat">
                        Privat
                      </option>
                      <option value="Cargo" data-i18n="flightClassCargo">
                        Cargo
                      </option>
                    </select>
                  </div>

                  <div class="lg:col-span-2">
                    <label
                      for="flightNumber"
                      data-i18n="form.flightNumberOptional"
                      class="block text-sm font-medium text-gray-700 dark:text-gray-300"
                      >Flugnummer (Optional)</label
                    >
                    <input
                      type="text"
                      id="flightNumber"
                      placeholder="z.B. LH400"
                      data-i18n="placeholder.egFlightNumber"
                      class="mt-1 block w-full rounded-lg border-gray-300 shadow-sm p-3"
                    />
                  </div>
                  <div class="lg:col-span-2">
                    <label
                      for="airline"
                      data-i18n="form.airline"
                      class="block text-sm font-medium text-gray-700 dark:text-gray-300"
                      >Airline (Optional)</label
                    >
                    <input
                      type="text"
                      id="airline"
                      placeholder="z.B. Lufthansa"
                      data-i18n="placeholder.egAirline"
                      class="mt-1 block w-full rounded-lg border-gray-300 shadow-sm p-3"
                    />
                  </div>
                  <div class="lg:col-span-2">
                    <label
                      for="aircraftType"
                      data-i18n="form.aircraft"
                      class="block text-sm font-medium text-gray-700 dark:text-gray-300"
                      >Flugzeugtyp (Optional)</label
                    >
                    <input
                      type="text"
                      id="aircraftType"
                      placeholder="z.B. A320"
                      data-i18n="placeholder.egAircraft"
                      class="mt-1 block w-full rounded-lg border-gray-300 shadow-sm p-3"
                    />
                  </div>

                  <div class="lg:col-span-2">
                    <label
                      for="registration"
                      data-i18n="form.registration"
                      class="block text-sm font-medium text-gray-700 dark:text-gray-300"
                      >Registrierung (Optional)</label
                    >
                    <input
                      type="text"
                      id="registration"
                      placeholder="z.B. D-AINC"
                      data-i18n="placeholder.egRegistration"
                      class="mt-1 block w-full rounded-lg border-gray-300 shadow-sm p-3"
                    />
                  </div>
                  <div class="lg:col-span-2">
                    <label
                      for="price"
                      data-i18n="priceNewFlight"
                      class="block text-sm font-medium text-gray-700 dark:text-gray-300"
                      >Ticketpreis (Optional)</label
                    >
                    <input
                      type="number"
                      id="price"
                      placeholder="z.B. 199.99"
                      data-i18n="placeholder.egPrice"
                      step="0.01"
                      class="mt-1 block w-full rounded-lg border-gray-300 shadow-sm p-3"
                    />
                  </div>
                  <div class="lg:col-span-2">
                    <label
                      for="currency"
                      data-i18n="currencyNewFlight"
                      class="block text-sm font-medium text-gray-700 dark:text-gray-300"
                      >W√§hrung (Optional)</label
                    >
                    <input
                      type="text"
                      id="currency"
                      placeholder="z.B. EUR"
                      data-i18n="placeholder.egCurrency"
                      maxlength="3"
                      class="mt-1 block w-full rounded-lg border-gray-300 shadow-sm p-3"
                    />
                  </div>

                  <div class="lg:col-span-3">
                    <label
                      data-i18n="form.photo"
                      class="block text-sm font-medium text-gray-700 dark:text-gray-300"
                      >Foto (Optional)</label
                    >
                    <div
                      id="existing-photos-preview"
                      class="mt-2 flex flex-wrap gap-2"
                    ></div>
                    <input
                      type="file"
                      id="flightPhoto"
                      accept="image/*"
                      class="hidden"
                      multiple
                    />
                    <label
                      for="flightPhoto"
                      data-i18n="form.chooseFile"
                      class="mt-1 inline-block bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-600 cursor-pointer"
                    >
                      Datei ausw√§hlen...
                    </label>
                    <div id="photo-preview-container" class="inline-block ml-4">
                      <p
                        id="photo-preview-text"
                        class="text-sm text-gray-600 dark:text-gray-400"
                        data-i18n="form.noFileSelected"
                      >
                        Keine Datei ausgew√§hlt
                      </p>
                    </div>
                  </div>
                  <div class="lg:col-span-3">
                    <label
                      for="notes"
                      data-i18n="notesNewFlight"
                      class="block text-sm font-medium text-gray-700 dark:text-gray-300"
                      >Bemerkungen (Optional)</label
                    >
                    <textarea
                      id="notes"
                      rows="3"
                      placeholder="Besondere Vorkommnisse oder pers√∂nliche Notizen..."
                      data-i18n="form.notesPlaceholder"
                      class="mt-1 block w-full rounded-lg border-gray-300 shadow-sm p-3 text-sm"
                    ></textarea>
                  </div>

                  <div class="lg:col-span-6">
                    <div class="grid grid-cols-2 md:grid-cols-3 gap-4 bg-indigo-100 dark:bg-slate-800 p-4 rounded-lg border border-indigo-200 dark:border-slate-700">
                      
                      <div>
                        <p data-i18n="estimatedDistanceNewFlight" class="text-xs font-medium text-indigo-700 dark:text-gray-400">
                          Gesch√§tzte Entfernung
                        </p>
                        <p id="distance-display" class="text-xl font-bold text-indigo-800 dark:text-gray-200">
                          -
                        </p>
                      </div>

                      <div>
                        <p data-i18n="estimatedFlightTimeNewFlight" class="text-xs font-medium text-indigo-700 dark:text-gray-400">
                          Gesch√§tzte Flugzeit
                        </p>
                        <p id="time-display" class="text-xl font-bold text-indigo-800 dark:text-gray-200">
                          -
                        </p>
                      </div>

                      <div class="col-span-2 md:col-span-1">
                        <p data-i18n="estimatedCO2Emissions" class="text-xs font-medium text-red-700 dark:text-red-400">
                          Gesch√§tzter CO‚ÇÇ-Aussto√ü
                        </p>
                        <p id="co2-display" class="text-xl font-bold text-red-800 dark:text-red-300">
                          -
                        </p>
                      </div>

                    </div> 
                  </div> 
                  </div> </details> 

              <div class="flex flex-col sm:flex-row items-stretch sm:items-center gap-4 mt-6">
                
                <button
                  onclick="logFlight()"
                  id="log-button"
                  disabled
                  data-i18n="logFlightNewFlight"
                  class="w-full py-3 px-4 rounded-lg transition-all duration-200 font-bold shadow-md
                         
                         /* LIGHT MODE (Aktiv) */
                         bg-blue-600 text-white hover:bg-blue-700 hover:shadow-lg hover:-translate-y-0.5
                         
                         /* LIGHT MODE (Deaktiviert) */
                         disabled:bg-blue-200 disabled:text-blue-50 disabled:shadow-none disabled:translate-y-0 disabled:cursor-not-allowed
                         
                         /* DARK MODE (Deaktiviert - Dein Wunsch: Bl√§ulich hinterlegt) */
                         dark:disabled:bg-blue-900/40 dark:disabled:text-blue-400/50 dark:disabled:border dark:disabled:border-blue-900/50
                         
                         /* DARK MODE (Aktiv) */
                         dark:bg-blue-600 dark:text-white dark:hover:bg-blue-500"
                >
                  Flug loggen und speichern
                </button>
				
				<button
                  onclick="resetForm()"
                  id="reset-button"
                  data-i18n="form.reset"
                  class="w-full sm:w-auto py-3 px-6 rounded-lg transition-colors font-medium border
                         bg-white border-gray-300 text-gray-700 hover:bg-gray-50
                         dark:bg-transparent dark:border-gray-600 dark:text-gray-300 dark:hover:bg-gray-800"
                >
                  Zur√ºcksetzen
                </button>
                
                <button
                  onclick="resetForm()"
                  id="cancel-edit-button"
                  class="hidden w-full sm:w-1/3 py-3 px-4 rounded-lg transition-colors font-semibold
                         bg-gray-200 text-gray-700 hover:bg-gray-300 
                         dark:bg-gray-700 dark:text-gray-200 dark:hover:bg-gray-600"
                >
                  Abbrechen
                </button>
              </div>
            </div>

            <div id="tab-content-fluege">
              <div
                class="flex items-center justify-between mb-4 border-b pb-2 border-gray-200 dark:border-gray-700"
              >
                <h2
                  class="text-xl md:text-2xl font-bold text-gray-800 dark:text-white"
                  data-i18n="flights.title"
                >
                  Gespeicherte Fl√ºge
                </h2>
                <div
                  class="grid grid-cols-2 gap-2 lg:flex lg:flex-wrap lg:items-center lg:space-x-4"
                >
                  <button
                    id="play-chronicle-btn"
                    class="w-full text-sm font-medium text-green-600 hover:text-green-800 p-2 rounded-lg bg-gray-100 dark:bg-gray-700 dark:hover:bg-gray-600 transition lg:w-auto"
                    data-i18n="flights.playChronicle"
                  >
                    ‚ñ∂Ô∏è Chronik abspielen
                  </button>
                  <button
                    id="toggle-map-view-btn"
                    onclick="toggleAllRoutesView()"
                    class="w-full text-sm font-medium text-indigo-600 hover:text-indigo-800 p-2 rounded-lg bg-gray-100 dark:bg-gray-700 dark:hover:bg-gray-600 transition lg:w-auto"
                    data-i18n="flights.showAllRoutes"
                  >
                    Alle Routen zeigen
                  </button>
                  <button
                    id="show-globe-btn"
                    class="w-full text-sm font-medium text-purple-600 hover:text-purple-800 p-2 rounded-lg bg-gray-100 dark:bg-gray-700 dark:hover:bg-gray-600 transition lg:w-auto"
                    data-i18n="flights.show3DGlobe"
                  >
                    üåç 3D Globus
                  </button>
                  <button
                    id="print-book-btn"
                    class="w-full text-sm font-medium text-blue-600 hover:text-blue-800 p-2 rounded-lg bg-gray-100 dark:bg-gray-700 dark:hover:bg-gray-600 transition lg:w-auto"
                    data-i18n="flights.createBook"
                  >
                    Buch erstellen
                  </button>
                  <button
                    onclick="renderFlights()"
                    class="w-full text-sm font-medium text-indigo-600 hover:text-indigo-800 flex items-center justify-center p-2 rounded-lg bg-gray-100 dark:bg-gray-700 dark:hover:bg-gray-600 transition lg:w-auto"
                    data-i18n="flights.refresh"
                  >
                    Aktualisieren
                  </button>
                </div>
              </div>
              <details
                class="bg-gray-50 dark:bg-gray-900 p-4 rounded-lg mb-4 border border-gray-200 dark:border-gray-700 group"
              >
                <summary class="list-none cursor-pointer">
                  <span
                    class="text-indigo-400 group-open:rotate-90 transition-transform duration-200 mr-2 inline-block"
                  >
                    >
                  </span>

                  <h3
                    class="text-lg font-semibold text-gray-800 dark:text-white inline-block"
                    data-i18n="flights.filterTitle"
                  >
                    Fl√ºge filtern
                  </h3>
                </summary>

                <div
                  class="grid grid-cols-2 lg:grid-cols-5 gap-4 items-end mt-4 border-t border-gray-200 dark:border-gray-700 pt-4"
                >
                  <div>
                    <label
                      for="filter-departure"
                      class="block text-sm font-medium text-gray-700 dark:text-gray-300"
                      data-i18n="flights.filterDeparture"
                      >Abflugort (IATA)</label
                    ><input
                      type="text"
                      id="filter-departure"
                      placeholder="z.B. FRA"
                      class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2"
                    />
                  </div>
                  <div>
                    <label
                      for="filter-arrival"
                      class="block text-sm font-medium text-gray-700 dark:text-gray-300"
                      data-i18n="flights.filterArrival"
                      >Zielort (IATA)</label
                    ><input
                      type="text"
                      id="filter-arrival"
                      placeholder="z.B. JFK"
                      class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2"
                    />
                  </div>
                  <div>
                    <label
                      for="filter-date-from"
                      class="block text-sm font-medium text-gray-700 dark:text-gray-300"
                      data-i18n="flights.filterDateFrom"
                      >Datum (von)</label
                    ><input
                      type="date"
                      id="filter-date-from"
                      class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2"
                    />
                  </div>
                  <div>
                    <label
                      for="filter-date-to"
                      class="block text-sm font-medium text-gray-700 dark:text-gray-300"
                      data-i18n="flights.filterDateTo"
                      >Datum (bis)</label
                    ><input
                      type="date"
                      id="filter-date-to"
                      class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2"
                    />
                  </div>
                  <div class="flex space-x-2 col-span-2 lg:col-span-1">
                    <button
                      onclick="applyFilters()"
                      class="w-full py-2 px-4 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 transition"
                      data-i18n="flights.filterButton"
                    >
                      Filtern</button
                    ><button
                      onclick="resetFilters()"
                      class="w-full py-2 px-4 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300 transition"
                      data-i18n="flights.resetButton"
                    >
                      Reset
                    </button>
                  </div>
                </div>
              </details>
              <div
                id="sort-bar"
                class="grid grid-cols-2 gap-2 mb-2 p-2 bg-gray-100 dark:bg-gray-700 rounded-md text-sm font-semibold lg:flex lg:flex-wrap lg:items-center"
              >
                <span
                  class="col-span-2 text-gray-600 dark:text-gray-300 lg:mr-2 lg:col-auto"
                  data-i18n="flights.sortBy"
                  >Sortieren nach:</span
                >

                <button
                  id="sort-btn-flightLogNumber"
                  onclick="setSortOrder('flightLogNumber')"
                  class="sort-btn flex-shrink-0 px-3 py-1 rounded-md transition hover:bg-gray-300 dark:hover:bg-gray-500 w-full lg:w-auto"
                >
                  #
                </button>
                <button
                  id="sort-btn-date"
                  onclick="setSortOrder('date')"
                  class="sort-btn flex-shrink-0 px-3 py-1 rounded-md transition hover:bg-gray-300 dark:hover:bg-gray-500 w-full lg:w-auto"
                  data-i18n="flights.sortDate"
                >
                  Datum
                </button>
                <button
                  id="sort-btn-departure"
                  onclick="setSortOrder('departure')"
                  class="sort-btn flex-shrink-0 px-3 py-1 rounded-md transition hover:bg-gray-300 dark:hover:bg-gray-500 w-full lg:w-auto"
                  data-i18n="flights.sortRoute"
                >
                  Route
                </button>

                <button
                  id="sort-btn-distance"
                  onclick="setSortOrder('distance')"
                  class="sort-btn flex-shrink-0 px-3 py-1 rounded-md transition hover:bg-gray-300 dark:hover:bg-gray-500 w-full lg:w-auto"
                  data-i18n="flights.sortDistance"
                >
                  Distanz
                </button>
              </div>
              <div
                id="flight-log-list"
                class="space-y-3 max-h-96 overflow-y-auto pr-2"
              ></div>
              <div
                id="pagination-controls"
                class="flex justify-between items-center mt-4 text-sm text-gray-600 dark:text-gray-400"
              >
                <button
                  id="prev-page-btn"
                  onclick="prevPage()"
                  class="px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-white rounded-md hover:bg-gray-300 dark:hover:bg-gray-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"
                  data-i18n="flights.prevButton"
                >
                  > ‚Äπ Zur√ºck
                </button>

                <span
                  id="page-info"
                  class="font-semibold text-gray-700 dark:text-gray-300"
                ></span>

                <button
                  id="next-page-btn"
                  onclick="nextPage()"
                  class="px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-white rounded-md hover:bg-gray-300 dark:hover:bg-gray-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"
                  data-i18n="flights.nextButton"
                >
                  Weiter ‚Ä∫
                </button>
              </div>
            </div>

            <div id="tab-content-stats">
              <div
                id="statistics-panel"
                class="grid grid-cols-2 md:grid-cols-4 gap-4 bg-gray-100 dark:bg-gray-900 p-4 rounded-lg text-center"
              >
                <div class="p-2 bg-white dark:bg-gray-800 rounded-md shadow-sm">
                  <p
                    class="text-xs font-medium text-gray-700 dark:text-gray-400"
                    data-i18n="stats.totalFlights"
                  >
                    Gesamte Fl√ºge
                  </p>
                  <p
                    id="stat-count"
                    class="text-xl font-bold text-indigo-800 dark:text-indigo-400"
                  >
                    0
                  </p>
                </div>
                <div class="p-2 bg-white dark:bg-gray-800 rounded-md shadow-sm">
                  <p
                    class="text-xs font-medium text-gray-700 dark:text-gray-400"
                    data-i18n="stats.totalDistance"
                  >
                    Gesamtdistanz
                  </p>
                  <p
                    id="stat-distance"
                    class="text-xl font-bold text-indigo-800 dark:text-indigo-400"
                  >
                    0 km
                  </p>
                </div>
                <div class="p-2 bg-white dark:bg-gray-800 rounded-md shadow-sm">
                  <p
                    class="text-xs font-medium text-gray-700 dark:text-gray-400"
                    data-i18n="stats.frequentAirport"
                  >
                    H√§ufigster Flughafen
                  </p>
                  <p
                    id="stat-frequent"
                    class="text-sm font-bold text-indigo-800 dark:text-indigo-400"
                  >
                    -
                  </p>
                </div>
                <div
                  class="p-2 bg-white dark:bg-gray-800 rounded-md shadow-sm col-span-2"
                >
                  <p
                    class="text-xs font-medium text-gray-700 dark:text-gray-400"
                    data-i18n="stats.totalSpending"
                  >
                    Gesamtausgaben
                  </p>
                  <p
                    id="stat-total-spending"
                    class="text-xl font-bold text-indigo-800 dark:text-indigo-400"
                  >
                    -
                  </p>
                </div>
                <div class="p-2 bg-white dark:bg-gray-800 rounded-md shadow-sm">
                  <p
                    class="text-xs font-medium text-gray-700 dark:text-gray-400"
                    data-i18n="stats.mostExpensive"
                  >
                    Teuerster Flug
                  </p>
                  <p
                    id="stat-most-expensive"
                    class="text-sm font-bold text-indigo-800 dark:text-indigo-400"
                  >
                    -
                  </p>
                </div>
                <div class="p-2 bg-white dark:bg-gray-800 rounded-md shadow-sm">
                  <p
                    class="text-xs font-medium text-gray-700 dark:text-gray-400"
                    data-i18n="stats.leastExpensive"
                  >
                    G√ºnstigster Flug
                  </p>
                  <p
                    id="stat-least-expensive"
                    class="text-sm font-bold text-indigo-800 dark:text-indigo-400"
                  >
                    -
                  </p>
                </div>

                <div class="p-2 bg-white dark:bg-gray-800 rounded-md shadow-sm">
                  <p
                    class="text-xs font-medium text-gray-700 dark:text-gray-400"
                    data-i18n="stats.longestFlight"
                  >
                    L√§ngster Flug
                  </p>
                  <p
                    id="stat-longest-flight"
                    class="text-sm font-bold text-indigo-800 dark:text-indigo-400"
                  >
                    -
                  </p>
                </div>
                <div class="p-2 bg-white dark:bg-gray-800 rounded-md shadow-sm">
                  <p
                    class="text-xs font-medium text-gray-700 dark:text-gray-400"
                    data-i18n="stats.shortestFlight"
                  >
                    K√ºrzester Flug
                  </p>
                  <p
                    id="stat-shortest-flight"
                    class="text-sm font-bold text-indigo-800 dark:text-indigo-400"
                  >
                    -
                  </p>
                </div>
                <div class="p-2 bg-white dark:bg-gray-800 rounded-md shadow-sm">
                  <p
                    class="text-xs font-medium text-gray-700 dark:text-gray-400"
                    data-i18n="stats.avgDistance"
                  >
                    √ò Flugdistanz
                  </p>
                  <p
                    id="stat-avg-distance"
                    class="text-xl font-bold text-indigo-800 dark:text-indigo-400"
                  >
                    0 km
                  </p>
                </div>
                <div class="p-2 bg-white dark:bg-gray-800 rounded-md shadow-sm">
                  <p
                    class="text-xs font-medium text-gray-700 dark:text-gray-400"
                    data-i18n="stats.frequentAircraft"
                  >
                    H√§ufigster Flugzeugtyp
                  </p>
                  <p
                    id="stat-frequent-aircraft"
                    class="text-sm font-bold text-indigo-800 dark:text-indigo-400"
                  >
                    -
                  </p>
                </div>

                <div class="p-2 bg-white dark:bg-gray-800 rounded-md shadow-sm">
                  <p
                    class="text-xs font-medium text-gray-700 dark:text-gray-400"
                    data-i18n="stats.avgCo2"
                  >
                    √ò CO‚ÇÇ pro Flug
                  </p>
                  <p
                    id="stat-avg-co2"
                    class="text-xl font-bold text-red-800 dark:text-red-400"
                  >
                    0 kg
                  </p>
                </div>
                <div
                  class="p-2 bg-white dark:bg-gray-800 rounded-md shadow-sm col-span-2 md:col-span-1"
                >
                  <p
                    class="text-xs font-medium text-gray-700 dark:text-gray-400"
                    data-i18n="stats.totalCo2"
                  >
                    Gesamter CO‚ÇÇ-Fu√üabdruck
                  </p>
                  <p
                    id="stat-total-co2"
                    class="text-xl font-bold text-red-800 dark:text-red-400"
                  >
                    0 kg
                  </p>
                </div>

                <div
                  class="col-span-2 md:col-span-4 p-2 bg-white dark:bg-gray-800 rounded-md shadow-sm"
                >
                  <div class="flex items-center justify-between">
                    <p
                      class="text-xs font-medium text-gray-700 dark:text-gray-400"
                      data-i18n="stats.yearlySummary"
                    >
                      Jahreszusammenfassung
                    </p>
                    <select
                      id="stat-year-select"
                      class="text-xs p-1 rounded border-gray-300 dark:bg-gray-700 dark:border-gray-600"
                    ></select>
                  </div>
                  <p
                    id="stat-yearly-summary"
                    class="text-lg font-bold text-indigo-800 dark:text-indigo-400 mt-2"
                  >
                    -
                  </p>
                </div>
              </div>
            </div>
            <div id="tab-content-charts" class="hidden">
              <div
                class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-md border border-gray-200 dark:border-gray-700"
              >
                <div
                  class="flex justify-between items-center mb-4 border-b border-gray-200 dark:border-gray-600 pb-2"
                >
                  <h2
                    class="text-xl md:text-2xl font-bold text-gray-800 dark:text-gray-100"
                    data-i18n="charts.title"
                  >
                    Visuelle Auswertungen
                  </h2>
                  <div class="flex items-center gap-2 text-sm">
                    <button
                      id="chart-view-year"
                      class="chart-view-btn active px-3 py-1 rounded-md transition"
                      data-i18n="charts.perYear"
                    >
                      Pro Jahr
                    </button>
                    <button
                      id="chart-view-month"
                      class="chart-view-btn px-3 py-1 rounded-md transition"
                      data-i18n="charts.perMonth"
                    >
                      Pro Monat
                    </button>
                  </div>
                </div>
                <div class="grid grid-cols-1 gap-8 mt-4">
                  <div>
                    <h3
                      class="font-semibold text-center text-gray-700 dark:text-gray-300 mb-2"
                      data-i18n="charts.flightsOverTime"
                    >
                      Fl√ºge pro Zeitraum
                    </h3>
                    <canvas id="flightsChart"></canvas>
                  </div>
                  <div>
                    <h3
                      class="font-semibold text-center text-gray-700 dark:text-gray-300 mb-2"
                      data-i18n="charts.distanceOverTime"
                    >
                      Distanz pro Zeitraum (km)
                    </h3>
                    <canvas id="distanceChart"></canvas>
                  </div>
                  <div>
                    <h3
                      class="font-semibold text-center text-gray-700 dark:text-gray-300 mb-2"
                      data-i18n="charts.durationOverTime"
                    >
                      Flugzeit pro Zeitraum
                    </h3>
                    <canvas id="timeChart"></canvas>
                  </div>
                </div>
              </div>
            </div>
            <div id="tab-content-logbook" class="hidden">
              <div
                class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-md border border-gray-200 dark:border-gray-700"
              >
                <div
                  class="flex justify-between items-center mb-4 border-b border-gray-200 dark:border-gray-600 pb-2"
                >
                  <h2
                    class="text-xl md:text-2xl font-bold text-gray-800 dark:text-gray-100"
                    data-i18n="logbook.title"
                  >
                    Logbuch-Ansichten
                  </h2>
                  <div
                    id="logbook-nav"
                    class="flex flex-wrap items-center gap-2 text-sm"
                  >
                    <button
                      id="logbook-view-aircraft"
                      class="logbook-view-btn active px-3 py-1 rounded-md transition"
                      data-i18n="logbook.byAircraft"
                    >
                      Nach Flugzeugtyp
                    </button>
                    <button
                      id="logbook-view-airline"
                      class="logbook-view-btn px-3 py-1 rounded-md transition"
                      data-i18n="logbook.byAirline"
                    >
                      Nach Airline
                    </button>
                    <button
                      id="logbook-view-airport"
                      class="logbook-view-btn px-3 py-1 rounded-md transition"
                      data-i18n="logbook.byAirport"
                    >
                      Nach Flughafen
                    </button>
                    <button
                      id="logbook-view-registration"
                      class="logbook-view-btn px-3 py-1 rounded-md transition"
                      data-i18n="logbook.byRegistration"
                    >
                      Nach Registrierung
                    </button>
                  </div>
                </div>
                <div id="logbook-content" class="mt-4 space-y-4"></div>
              </div>
            </div>

            <div id="tab-content-achievements" class="hidden">
              <div
                class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-md border border-gray-200 dark:border-gray-700"
              >
                <h2
                  class="text-xl md:text-2xl font-bold text-gray-800 dark:text-gray-100 mb-4"
                  data-i18n="achievements.title"
                >
                  Deine Errungenschaften
                </h2>
                <div
                  id="achievements-container"
                  class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"
                ></div>
                <h2
                  class="text-xl md:text-2xl font-bold text-gray-800 dark:text-gray-100 mt-8 border-t dark:border-gray-700 pt-6 mb-4"
                  data-i18n="achievements.recordsTitle"
                >
                  Pers√∂nliche Rekorde & "Firsts"
                </h2>
                <div
                  id="records-container"
                  class="grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4"
                ></div>
              </div>
            </div>
			
			<div id="tab-content-hilfe" class="hidden">
              <div
                class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-md border border-gray-200 dark:border-gray-700"
              >
                <h2 class="text-xl md:text-2xl font-bold text-gray-800 dark:text-gray-100 mb-4" data-i18n="help.title">
                  Hilfe & FAQ
                </h2>
                
                <div id="help-content-container" class="prose dark:prose-invert max-w-none space-y-4 text-gray-700 dark:text-gray-300">
                  </div>
              </div>
            </div>
			
          </div>
        </div>
      </div>
    </div>

    <div
      id="password-change-modal"
      class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden items-center justify-center p-4 z-50"
    >
      <div
        class="bg-white dark:bg-gray-800 rounded-xl shadow-2xl p-6 w-full max-w-md"
      >
        <h3 class="text-xl font-bold text-gray-800 dark:text-white mb-4">
          Neues Passwort festlegen
        </h3>
        <form id="password-change-form" class="space-y-4">
          <div>
            <label
              for="new-password"
              class="block text-sm font-medium text-gray-700 dark:text-gray-300"
              >Neues Passwort</label
            >
            <input
              type="password"
              id="new-password"
              placeholder="Mindestens 6 Zeichen"
              class="mt-1 w-full p-3 rounded-lg border-gray-300 dark:bg-gray-700 dark:border-gray-600"
            />
          </div>
          <div class="flex justify-end gap-4">
            <button
              type="button"
              onclick="closePasswordChangeModal(event)"
              class="px-4 py-2 bg-gray-200 dark:bg-gray-600 rounded-md hover:bg-gray-300 dark:hover:bg-gray-500 transition"
            >
              Abbrechen
            </button>
            <button
              type="submit"
              class="px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 transition"
            >
              Speichern
            </button>
          </div>
        </form>
      </div>
    </div>

    <div
      id="info-modal"
      class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden items-center justify-center p-4 z-50 backdrop-blur-sm"
    >
      <div
        class="bg-white dark:bg-gray-800 rounded-xl shadow-2xl w-full max-w-lg max-h-[90vh] flex flex-col border border-gray-200 dark:border-gray-700"
      >
        
        <div
          class="flex justify-between items-center border-b p-4 dark:border-gray-700 bg-white dark:bg-gray-800 rounded-t-xl shrink-0"
        >
          <h3
            id="info-modal-title"
            class="text-xl font-bold text-gray-800 dark:text-white truncate pr-4"
          >
            Modal-Titel
          </h3>
          <button
            onclick="closeInfoModal()"
            class="text-gray-400 hover:text-gray-600 dark:hover:text-white p-1 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition"
          >
            <svg
              class="w-6 h-6"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M6 18L18 6M6 6l12 12"
              ></path>
            </svg>
          </button>
        </div>

        <div
          id="info-modal-content"
          class="p-6 overflow-y-auto text-sm text-gray-700 dark:text-gray-300"
        >
          <p>Lade Details...</p>
        </div>
        
      </div>
    </div>

    <div
      id="globe-modal"
      class="hidden fixed inset-0 w-full h-screen bg-black bg-opacity-70 z-40"
    >
      <div
        id="globe-slider-container"
        class="absolute top-4 left-1/2 -translate-x-1/2 z-50 w-full max-w-xl p-4 hidden"
      >
        <div class="bg-black/50 backdrop-blur-sm p-3 rounded-lg shadow-xl">
          <input
            id="globe-time-slider"
            type="range"
            min="0"
            max="100"
            value="100"
            class="w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer range-lg"
          />
          <div class="text-center mt-2">
            <span
              id="globe-time-label"
              class="text-xs font-medium text-white/80"
            >
              Lade Zeitstrahl...
            </span>
          </div>
          <div class="text-center mt-3">
            <button
              id="globe-story-mode-btn"
              onclick="toggleStoryMode()"
              data-i18n="globe.buttonStoryMode" class="text-xs text-white bg-blue-600 hover:bg-blue-700 px-3 py-1 rounded-md transition-colors"
            >
              üìñ Story-Modus
            </button>
          </div>
        </div>
      </div>

      <div id="globe-container" class="w-full h-full"></div>

      <button
        onclick="closeGlobeModal()"
        class="absolute top-6 right-6 text-white z-50 p-2 bg-black bg-opacity-30 rounded-full hover:bg-opacity-50 transition"
      >
        <svg
          class="w-6 h-6"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M6 18L18 6M6 6l12 12"
          ></path>
        </svg>
      </button>
    </div>

    <input type="file" id="import-file-input" accept=".json" class="hidden" />

    <div id="toast-container" class="fixed top-5 right-5 z-50 space-y-2"></div>
	
	<div id="print-view-content" class="hidden print:block"></div>
	
	<div id="premium-modal" class="hidden fixed inset-0 z-50 overflow-y-auto" aria-labelledby="modal-title" role="dialog" aria-modal="true">
  <div class="flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0">
    <div class="fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity backdrop-blur-sm" aria-hidden="true" onclick="closePremiumModal()"></div>

    <span class="hidden sm:inline-block sm:align-middle sm:h-screen" aria-hidden="true">&#8203;</span>

    <div class="relative inline-block align-bottom bg-white dark:bg-gray-800 rounded-2xl text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg w-full border-2 border-indigo-500 dark:border-indigo-400">
      
      <div id="premium-modal-image-container" class="hidden w-full h-48 bg-gray-100 dark:bg-gray-900 overflow-hidden flex items-center justify-center relative">
          <img id="premium-modal-image" src="" alt="Feature Preview" class="w-full h-full object-cover opacity-90">
          <div class="absolute inset-0 bg-gradient-to-t from-white dark:from-gray-800 via-transparent to-transparent opacity-50"></div>
      </div>

      <div class="bg-indigo-50 dark:bg-indigo-900/30 px-4 py-5 sm:px-6 flex items-center justify-between">
        <div>
            <h3 class="text-xl leading-6 font-bold text-gray-900 dark:text-white" id="modal-title" data-i18n="premium.title">
              Unlock Full Potential üöÄ
            </h3>
            <p class="mt-1 max-w-2xl text-sm text-gray-500 dark:text-gray-400" data-i18n="premium.subtitle">
              Upgrade to Pro and remove all limits.
            </p>
        </div>
        <button type="button" onclick="closePremiumModal()" class="bg-transparent rounded-md text-gray-400 hover:text-gray-500 focus:outline-none">
          <span class="sr-only">Close</span>
          <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
          </svg>
        </button>
      </div>
	  
<div class="px-4 pt-5 pb-2 sm:px-6">
    <div class="relative bg-gray-100 dark:bg-gray-700 p-1 rounded-lg flex">
        <button type="button" id="plan-monthly-btn" onclick="switchPlan('monthly')" class="w-1/2 py-2 text-sm font-medium rounded-md transition-all text-gray-500 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white focus:outline-none">
            <span data-i18n="premium.monthly">Monatlich</span>
        </button>

        <button type="button" id="plan-yearly-btn" onclick="switchPlan('yearly')" class="w-1/2 py-2 text-sm font-medium rounded-md transition-all bg-white dark:bg-gray-600 shadow-sm text-gray-900 dark:text-white focus:outline-none relative">
            <span data-i18n="premium.yearly">J√§hrlich</span>
            <span class="absolute -top-2 -right-2 bg-green-500 text-white text-[10px] font-bold px-1.5 py-0.5 rounded-full shadow-sm">
                -50%
            </span>
        </button>
    </div>
</div>	  

      <div class="px-4 py-5 sm:p-6">
        <ul class="space-y-4">
          <li class="flex items-start">
            <div class="flex-shrink-0">
              <svg class="h-6 w-6 text-green-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
              </svg>
            </div>
            <div class="ml-3">
              <p class="text-base font-medium text-gray-900 dark:text-white" data-i18n="premium.feature1">Unbegrenzte Fl√ºge</p>
              <p class="text-sm text-gray-500 dark:text-gray-400" data-i18n="premium.desc1">Kein 15-Fl√ºge-Limit mehr.</p>
            </div>
          </li>

          <li class="flex items-start">
            <div class="flex-shrink-0">
              <svg class="h-6 w-6 text-green-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
              </svg>
            </div>
            <div class="ml-3">
              <p class="text-base font-medium text-gray-900 dark:text-white" data-i18n="premium.feature2">3D Globus Ansicht</p>
              <p class="text-sm text-gray-500 dark:text-gray-400" data-i18n="premium.desc2">Interaktive 3D-Reisehistorie.</p>
            </div>
          </li>

          <li class="flex items-start">
            <div class="flex-shrink-0">
              <svg class="h-6 w-6 text-green-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
              </svg>
            </div>
            <div class="ml-3">
              <p class="text-base font-medium text-gray-900 dark:text-white" data-i18n="premium.feature3">Foto Upload & PDF</p>
              <p class="text-sm text-gray-500 dark:text-gray-400" data-i18n="premium.desc3">Speichere Erinnerungen & erstelle B√ºcher.</p>
            </div>
          </li>
        </ul>
      </div>

      <div class="px-4 py-4 sm:px-6 bg-gray-50 dark:bg-gray-700/50 flex flex-col sm:flex-row justify-between items-center gap-3">
        <div class="text-sm text-gray-500 dark:text-gray-400 text-center sm:text-left">
        <span id="premium-price-amount" class="font-bold text-lg text-gray-900 dark:text-white">14,99 ‚Ç¨</span> 
        <span id="premium-price-period" data-i18n="premium.perYear">/ Jahr</span>
    </div>
        <button id="buy-pro-btn" type="button" class="w-full sm:w-auto inline-flex justify-center rounded-lg border border-transparent shadow-sm px-6 py-3 bg-indigo-600 text-base font-medium text-white hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-transform transform hover:scale-105">
          <span data-i18n="premium.cta">Jetzt upgraden</span> ‚ú®
        </button>
      </div>

    </div>
  </div>
</div>
	
    <script>
      // JavaScript befindet sich in .js/*.js

    </script>
  </body>
</html>
